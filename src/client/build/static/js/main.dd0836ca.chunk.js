(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{34:function(e,t,a){e.exports=a(61)},39:function(e,t,a){},40:function(e,t,a){},41:function(e,t,a){},42:function(e,t,a){},48:function(e,t,a){},49:function(e,t,a){},51:function(e,t,a){},58:function(e,t,a){},59:function(e,t,a){},60:function(e,t,a){},61:function(e,t,a){"use strict";a.r(t);var n=a(1),c=a.n(n),r=a(23),l=a.n(r),o=(a(39),a(5)),s=a(11),u=a(15),i=a(3),m=(a(40),a(24));function p(){return c.a.createElement("div",{className:"Loading"},c.a.createElement(m.a,null))}var d=c.a.createContext(),f=function(e){var t=e.children,a=Object(n.useState)({}),r=Object(i.a)(a,2),l=r[0],o=r[1],s=Object(n.useState)(!0),m=Object(i.a)(s,2),f=m[0],b=m[1];return Object(n.useEffect)((function(){fetch("/api/blog/config").then((function(e){return e.json()})).then((function(e){return o(e.config)})).catch((function(e){console.log(e)}))}),[]),Object(n.useEffect)((function(){Object.keys(l).length>0&&l.constructor===Object&&(console.log(l),b(!1))}),[l]),f?c.a.createElement(p,null):c.a.createElement(d.Provider,{value:{data:l,update:function(e){return new Promise((function(t,a){fetch("/api/blog/config",{method:"put",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){e.ok?(o(Object(u.a)({},e.config)),t("Config updated")):a("Could not update the config")})).catch((function(e){return a("Something went wrong with the server")}))}))}}},t)},b=(a(41),c.a.createContext());function g(e){var t=e.children,a=Object(n.useState)({}),r=Object(i.a)(a,2),l=r[0],o=r[1];return c.a.createElement(b.Provider,{value:o},t,l.type&&l.text?c.a.createElement("div",{className:"error"===l.type?"message-alert error":"message-alert success"},c.a.createElement("span",{className:"message-alert--text"},l.text),c.a.createElement("button",{className:"message-alert--close",onClick:function(){return o({})}},"x")):null)}var E=a(33),h=(a(42),a(13));function v(e){var t=e.last,a=e.children,n=Object(E.a)(e,["last","children"]);return c.a.createElement("li",{className:t?"nav-item nav-item--last":"nav-item"},c.a.createElement(o.c,Object.assign({className:"nav-link"},n),a))}function j(e){var t=e.logo,a=e.logoTo,r=e.admin,l=e.children,u=Object(s.g)(),m=Object(n.useState)(!1),p=Object(i.a)(m,2),d=p[0],f=p[1],b=function(){return f((function(e){return!e}))};return Object(n.useEffect)((function(){d&&(console.log(u),f(!1))}),[u.pathname]),c.a.createElement("nav",{className:r?"navbar admin":"navbar blog"},c.a.createElement("div",{className:r?"navbar-center admin page-center":"navbar-center blog page-center"},c.a.createElement("div",{className:"navbar-logo border-white"},c.a.createElement(o.b,{to:a},t)),c.a.createElement("ul",{className:d?"navbar-nav navbar-nav--show":"navbar-nav"},c.a.createElement("li",{className:"navbar-nav-title"},"Menu"),l),c.a.createElement("div",{className:"navbar-nav--closer",style:d?{display:"block"}:{display:"none"},onClick:b}),c.a.createElement("div",{className:"navbar-btn border-white",onClick:b},c.a.createElement(h.a,null))))}a(48),a(49);function O(e){var t=e.post,a=e.admin,r=e.mobile,l=Object(n.useState)(new Date(t.createdAt)),s=Object(i.a)(l,1)[0],u=Object(n.useRef)(null);Object(n.useEffect)((function(){}));return c.a.createElement("div",{className:r?"PostCard border-gray PostCard--mobile":"PostCard border-gray",ref:u},c.a.createElement("div",{className:"PostCard-image",style:{backgroundImage:"url(".concat(t.mainImage,")")}}),c.a.createElement("div",{className:"PostCard-title"},c.a.createElement(o.b,{to:a?"/admin/posts/edit/".concat(t.slug):"/posts/".concat(t.slug)},c.a.createElement("h2",null,t.title))),c.a.createElement("div",{className:"PostCard-date"},c.a.createElement(h.d,{className:"PostCard-date--icon"}),c.a.createElement("span",null,"".concat(["January","February","March","April","May","June","July","August","September","October","November","December"][s.getMonth()]," ").concat(s.getDay(),", ").concat(s.getFullYear()))),c.a.createElement("div",{className:"PostCard-resume"},c.a.createElement("p",null,t.resume)),c.a.createElement("div",{className:"PostCard-tags"},t.tags.map((function(e,t){return c.a.createElement("span",{key:t},e)}))))}var N=0,y=10,w="date";function C(e){var t=e.admin,a=Object(n.useContext)(b),r=Object(n.useState)([]),l=Object(i.a)(r,2),s=l[0],u=l[1],m=Object(n.useState)(!0),d=Object(i.a)(m,2),f=d[0],g=d[1],E=Object(n.useState)(!1),h=Object(i.a)(E,2),v=h[0],j=h[1],N=Object(n.useRef)(null),y=function(){N.current.offsetWidth<500?j(!0):j(!1)};return Object(n.useEffect)((function(){k().then((function(e){u(e)})).catch((function(e){return a({type:"error",text:"Couldn't get the posts"})}))}),[]),Object(n.useEffect)((function(){s[0]&&(console.log("Posts",s),g(!1))}),[s]),Object(n.useEffect)((function(){if(!f)return y(),window.addEventListener("resize",y),function(){window.removeEventListener("resize",y)}}),[f]),f?c.a.createElement(p,null):c.a.createElement("div",{className:"Posts-page",ref:N},c.a.createElement("div",{className:"page-header"},t?c.a.createElement(c.a.Fragment,null,c.a.createElement("h1",null,"Create new post")," ",c.a.createElement(o.b,{className:"btn",to:"/admin/posts/new"},"Create")):c.a.createElement("h1",null,"Lastest Posts")),c.a.createElement("div",{className:"Posts-wrapper"},s.map((function(e){return c.a.createElement(O,{post:e,key:e.slug,mobile:v,admin:t})}))))}var k=function(e){return new Promise((function(t,a){var n="/api/posts",c=[],r=e||{},l=r.skip,o=r.limit,s=r.sort;l&&l!==N&&c.push("skip=".concat(l)),o&&o!==y&&c.push("limit=".concat(o)),s&&l!==w&&c.push("sort=".concat(s)),c[0]&&(n+="?"+c.join("&")),console.log("Fetching post from: ",n),fetch(n).then((function(e){return e.json()})).then((function(e){if(e.ok)return t(e.posts);a(e.msg)})).catch((function(e){console.log(e),a(e)}))}))},x=a(20),S=a.n(x),P=a(27),B=(a(51),a(28)),F=a.n(B),A=a(29),T=a.n(A),J=a(30),D=a.n(J),L=a(31),M=a.n(L),_={header:D.a,image:{class:M.a,config:{uploader:{uploadByFile:function(e){return new Promise((function(t,a){var n=new FormData;n.append("file",e),fetch("/api/uploads/new",{method:"post",body:n}).then((function(e){return e.json()})).then((function(e){if(e.ok)return t({success:1,file:{url:"/api/uploads/".concat(e.file.filename),filename:e.file.filename}});a({success:0,msg:e.msg})}))}))},uploadByUrl:function(e){return new Promise((function(t,a){console.log("Url: ",e),fetch(e).then((function(e){return e.blob()})).then((function(e){var n=new FormData;n.append("file",e),fetch("/api/uploads/new",{method:"post",body:n}).then((function(e){return e.json()})).then((function(e){e.ok?t({success:1,file:{url:"/api/uploads/".concat(e.file.filename),filename:e.file.filename}}):a({success:0,msg:e.msg})}))})).catch((function(e){return a({success:0})}))}))}}}}},I=function(e){return e.toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-")};function R(e){var t=e.edit,a=Object(s.h)(),r=Object(n.useState)([]),l=Object(i.a)(r,2),o=l[0],u=l[1],m=Object(n.useState)(""),d=Object(i.a)(m,2),f=d[0],g=d[1],E=Object(n.useState)(""),v=Object(i.a)(E,2),j=v[0],O=v[1],N=Object(n.useState)(!0),y=Object(i.a)(N,2),w=y[0],C=y[1],k=Object(n.useState)({}),x=Object(i.a)(k,2),B=x[0],A=x[1],J=Object(n.useState)({}),D=Object(i.a)(J,2),L=D[0],M=D[1],R=Object(n.useState)(!0),U=Object(i.a)(R,2),z=U[0],H=U[1],W=Object(n.useState)(!1),q=Object(i.a)(W,2),Y=q[0],G=q[1],K=Object(n.useContext)(b);Object(n.useEffect)((function(){t?(fetch("/api/posts/".concat(a.slug)).then((function(e){return e.json()})).then((function(e){if(e.ok){var t=e.post;console.log("Post fetched",t),g(t.title),u(t.tags),O(t.slug),M({holder:"editor-js",slug:a.slug,data:{blocks:t.blocks},tools:_})}else K({type:"error",text:e.msg});H(!1)})).catch((function(e){K({type:"error",text:"Could not request post"}),H(!1),console.log(e)})),console.log("edit mode")):(M({holder:"editor-js",tools:_}),H(!1),console.log("new mode"))}),[]),Object(n.useEffect)((function(){Object.keys(L).length>0&&!z&&(console.log("The config which EditorJS is created with",L),A(new F.a(L)))}),[L,z]),Object(n.useEffect)((function(){if(B.destroy)return function(){B.destroy()}}),[B]);var Q=function(){var e=Object(P.a)(S.a.mark((function e(a){var n,c,r;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.save();case 2:if(n=e.sent,f){e.next=5;break}return e.abrupt("return",K({type:"error",text:"Add title"}));case 5:if(j){e.next=7;break}return e.abrupt("return",K({type:"error",text:"Add url"}));case 7:if(!(o.length<2)){e.next=9;break}return e.abrupt("return",K({type:"error",text:"Add at least 2 tags"}));case 9:if(0!==n.blocks.length){e.next=11;break}return e.abrupt("return",K({type:"error",text:"the post body is empty"}));case 11:c={title:f,slug:j,tags:o,blocks:n.blocks,editorjs_v:n.version},console.log("Post saved by btn",c),r={},t?(r.url="/api/posts/".concat(L.slug),r.method="put"):(r.url="/api/posts/new",r.method="post"),console.log("Where is being fetched",r),fetch(r.url,{method:r.method,body:JSON.stringify(c),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){console.log("Response Fetched after saving",e),e.ok?(G(!0),K({type:"success",text:e.msg})):K({type:"error",text:e.msg})})).catch((function(e){console.error("Something went wrong while saving",e),K({type:"error",text:"Could not get to the server"})}));case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){fetch("/api/posts/".concat(L.slug),{method:"delete"}).then((function(e){return e.json()})).then((function(e){e.ok?(G(!0),K({type:"success",text:e.msg})):K({type:"error",text:e.msg})})).catch((function(e){return K({type:"error",text:"Could not get to the server"})}))};return z?c.a.createElement(p,null):c.a.createElement(c.a.Fragment,null,Y?c.a.createElement(s.a,{to:"/admin/posts"}):"",c.a.createElement("div",{className:"page-center"},c.a.createElement("div",{className:"page-header"},t?c.a.createElement(c.a.Fragment,null,c.a.createElement("h1",null,"Edit Post"),c.a.createElement("div",{className:"btn-wrapper"},c.a.createElement("button",{className:"btn bg-danger",onClick:V},"Delete"),c.a.createElement("button",{className:"btn",onClick:Q},"Edit"))):c.a.createElement(c.a.Fragment,null,c.a.createElement("h1",null,"Create Post"),c.a.createElement("div",{className:"btn-wrapper"},c.a.createElement("button",{className:"btn",onClick:Q},"Create")))),c.a.createElement("div",{className:"post-info"},c.a.createElement("label",{className:"input-wrapper"},c.a.createElement("span",{className:"input-name"},"Title"),c.a.createElement("input",{type:"text",name:"title",value:f,onChange:function(e){w&&O(I(e.target.value)),g(e.target.value)},placeholder:"Add title"})),c.a.createElement("label",{className:"input-wrapper"},c.a.createElement("span",{className:"input-name"},"Tags"),c.a.createElement(T.a,{value:o,onChange:function(e){return u(e)}})),c.a.createElement("label",{className:"input-wrapper"},c.a.createElement("span",{className:"input-name"},"Url"),c.a.createElement("input",{type:"text",name:"slug",value:j,onChange:function(e){return O(I(e.target.value))},placeholder:"url",disabled:w}),c.a.createElement("button",{className:"slug-input-btn",onClick:function(e){return C((function(e){return!e}))}},w?c.a.createElement(h.b,null):c.a.createElement(h.c,null)))),c.a.createElement("div",{id:"editor-js",className:"border-gray"})))}var U=a(16);function z(){var e=Object(n.useContext)(d),t=Object(n.useContext)(b),a=Object(n.useState)({}),r=Object(i.a)(a,2),l=r[0],o=r[1],s=Object(n.useState)(!0),m=Object(i.a)(s,2),f=m[0],g=m[1];Object(n.useEffect)((function(){o(Object(u.a)({},e.data))}),[e]),Object(n.useEffect)((function(){Object.keys(l).length>0&&g(!1)}),[l]);var E=function(e){var t=e.target,a=t.name,n=t.value;"name"===a&&n.length>40&&(n=n.substring(0,40)),o((function(e){return Object(u.a)({},e,Object(U.a)({},a,n))}))};return f?c.a.createElement(p,null):c.a.createElement("div",{className:"page-center"},c.a.createElement("div",{className:"page-header"},c.a.createElement("h1",null,"Blog config"),c.a.createElement("button",{className:"btn",onClick:function(){e.update(Object(u.a)({},l)).then((function(e){return t({type:"success",text:e})})).catch((function(e){return t({type:"error",text:e})}))}},"Save")),c.a.createElement("br",null),c.a.createElement("label",{className:"input-wrapper"},c.a.createElement("span",{className:"input-name"},"Blog Name"),c.a.createElement("input",{type:"text",name:"name",value:l.name,onChange:E,placeholder:"Max: 40 characters"})),c.a.createElement("label",{className:"input-wrapper"},c.a.createElement("span",{className:"input-name"},"Twitter Handle"),c.a.createElement("input",{type:"text",name:"twitter",value:l.twitter,onChange:E,placeholder:"without @"})),c.a.createElement("label",{className:"input-wrapper"},c.a.createElement("span",{className:"input-name"},"Author"),c.a.createElement("input",{type:"text",name:"author",value:l.author,onChange:E})),c.a.createElement("label",{className:"input-wrapper"},c.a.createElement("span",{className:"input-name"},"Author profession"),c.a.createElement("input",{type:"text",name:"author_profession",value:l.author_profession,onChange:E})))}function H(){return c.a.createElement("div",null,c.a.createElement(g,null,c.a.createElement(j,{logo:"Blog admin",logoTo:"/admin/posts",admin:!0},c.a.createElement(v,{to:"/admin/posts"},"Posts"),c.a.createElement(v,{to:"/admin/config"},"Config"),c.a.createElement(v,{to:"/",last:!0},"Logout")),c.a.createElement(s.d,null,c.a.createElement(s.b,{exact:!0,path:"/admin/posts"},c.a.createElement("div",{className:"page-center"},c.a.createElement(C,{admin:!0}))),c.a.createElement(s.b,{path:"/admin/posts/new"},c.a.createElement(R,null)),c.a.createElement(s.b,{path:"/admin/posts/edit/:slug"},c.a.createElement(R,{edit:!0})),c.a.createElement(s.b,{path:"/admin/config"},c.a.createElement(z,null)),c.a.createElement(s.b,null,c.a.createElement(s.a,{to:"/admin/posts"})))))}a(58);var W=a(32);a(59);function q(e){var t=e.blogName,a=e.author,n=e.prof;return c.a.createElement("div",{className:"blog-header-bg"},c.a.createElement("div",{className:"blog-header page-center"},c.a.createElement("div",{className:"blog-header-left"},c.a.createElement("div",{className:"blog-header-title"},c.a.createElement("h1",null,t))),c.a.createElement("div",{className:"blog-header-right"},c.a.createElement("div",{className:"blog-header-author"},c.a.createElement("h2",null,a)),c.a.createElement("div",{className:"blog-header-prof"},c.a.createElement("h2",null,n)))))}a(60);function Y(){var e=Object(s.h)().slug,t=Object(n.useState)(!0),a=Object(i.a)(t,2),r=a[0],l=a[1],o=Object(n.useState)({}),u=Object(i.a)(o,2),m=u[0],d=u[1];return Object(n.useEffect)((function(){fetch("/api/posts/".concat(e)).then((function(e){return e.json()})).then((function(e){e.ok?(d(e.post),console.log(e.post)):console.log("Post not found")}))}),[]),Object(n.useEffect)((function(){Object.keys(m).length>0&&l(!1)}),[m]),r?c.a.createElement(p,null):c.a.createElement("div",{className:"SinglePost-page"},c.a.createElement("div",{className:"page-header"},c.a.createElement("h1",null,m.title)),c.a.createElement("div",{className:"SinglePost-body"},m.blocks.map((function(e,t){return"paragraph"===e.type?c.a.createElement("p",{className:"SinglePost-body-p",key:t},e.data.text):"image"===e.type?c.a.createElement("div",{className:"SinglePost-body-img",key:t},c.a.createElement("img",{src:e.data.file.url,alt:"post"}),c.a.createElement("p",{className:"SinglePost-body-img-caption"},e.data.caption)):void 0}))))}function G(e){var t=Object(n.useContext)(d).data,a=Object(n.useState)(!1),r=Object(i.a)(a,2),l=r[0],o=r[1];return c.a.createElement("div",null,c.a.createElement(j,{logo:"Blog",logoTo:"/"},c.a.createElement(v,{to:"/"},"Home"),c.a.createElement(v,{to:"/about"},"About")),c.a.createElement(q,{blogName:t.name,author:t.author,prof:t.author_profession}),c.a.createElement("div",{className:"Blog-grid page-center"},c.a.createElement("div",{className:"Blog-body"},c.a.createElement(s.d,null,c.a.createElement(s.b,{exact:!0,path:"/"},c.a.createElement(C,null)),c.a.createElement(s.b,{exact:!0,path:"/posts/:slug"},c.a.createElement(Y,null)))),c.a.createElement("div",{className:l?"Blog-panel show":"Blog-panel"},c.a.createElement("div",{className:"Blog-panel-btn",onClick:function(){return o((function(e){return!e}))}},"Panel"),c.a.createElement("div",{className:"Blog-panel-content"},c.a.createElement(W.a,{sourceType:"profile",screenName:t.twitter,options:{height:"100vh"}})),c.a.createElement("div",{className:"Blog-panel--closer",onClick:function(){return o((function(e){return!e}))}}))))}l.a.render(c.a.createElement((function(){return c.a.createElement(f,null,c.a.createElement(o.a,null,c.a.createElement(s.d,null,c.a.createElement(s.b,{path:"/admin"},c.a.createElement(H,null)),c.a.createElement(s.b,{path:"/"},c.a.createElement(G,null)))))}),null),document.getElementById("app"))}},[[34,1,2]]]);
//# sourceMappingURL=main.dd0836ca.chunk.js.map